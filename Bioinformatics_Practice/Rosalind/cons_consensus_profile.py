# ============================================================
# ROSALIND PROBLEM: CONS - Consensus and Profile
# INPUT: DNA strings in FASTA format (paste below)
# OUTPUT: Consensus string and profile matrix
# ============================================================

fasta_input = """
>Rosalind_4259
TTCGGACTCTACACCAAAGGCTGAGGTGGCTGCTACGTAACCCCAAGCCTATTACGAACT
ATACGGGTTTGGGCAGTCGTTGGAAGGTCCTAATCTGTTCCGTAACTAAAGCAGCAGGCG
GCTACATGTACATATTACATTAATTCTCATGCGGTCCAGTAGTTATGGTGCAATCATCCA
AGCACGAGGAGTTGCATCGAACAAACCGGACCGAAAAACGATTTTAGCCGCTCGAATGCG
TAAATTTCAGTCCTACACCATCGGATGAACCTGTCCTTTTATCGGAAGATTTGGATTGAC
AGCACTGGGGCGCCGACATTCGAGAGCTGGTAATCCGGGCCGGGAAGGGACTTGCTAATC
TCTCATCGCGGGGCGCAGGGAAGTGGACACCTTCCGATCGTCCCTAAATTATACACCATC
CACCAGTCCGAGGTTCCCTAAGAGTGGTTGGTGTTCGGCCGGACCGCCTCCGTAGATCGT
TAGACCCTACGGCAGAACGAGTCAAGCCTTCCAAAGAAACAGACACGCTGGAGGAGACAG
CAACTTGTGCCCAGCCATTGATCACGTGTGCGACTGGTGACTATGGAAATTATACGATAG
GAATCTGATGCACGCGACCATTACTTCCTGCCGCTCTGGGTTGACTTTCGGTGGCATGCT
AATAGACATAATAACCTGTAGCACTCCTTTGCCTTACAGTAGTTACAGTTAGGACAACCT
TCTGTTTAGATCGTAGTACCCACTACTCTTTAGCGTGCTGTTCGCTGGTGTCCCCAGTAT
TGCGTGTGTGGTAACCCATCTTAGAAAGAAAGTAACCACGCCCTTAGGTTCCGCAACGCC
TCTGCGTTCTCTGCTCGGGATCCCGAACCTAGATTGCATCAGGCGAACAATCTTTGACAT
GGCTACTTGCAACTAGCGCAAAACTCCGTGCTACTCAGAACGACAGTAGGCT
>Rosalind_1742
ATCGGGTGAGACATAGTGTGTGAAGGGATATCATCGCTCGACTAGTGGCTCCATTGCTTT
CTTGTGTGATGGTGAACAATACTGAGGATTCGACAATGTCGTCAGGTTTTAGATATGTTC
CTACTGCTGTTTTAGACACCAGGACTCGTCTTTTCGATATATACCCATCGTCCGCGCGAT
ACTGGGACGTACGTAGAATATTGGCACGGTAGTAGGCTACATTTACCTGTAAGAACCTGG
GAAGCGCTCCTCACATTGAGTTCTCGCCTTTCTTGAGCGGGAGCCGCCCGACATAAATTG
TTACGATTCGAAATACTAGGCGGGGTCCGCTTACATGACTCTACACAGGCGAAGAAAAGG
CGCTTCTGAAAGAACTCCGGCTGCGCGGTCGCCCCGTACCGCCTGGTGCGTTAAAGCCTG
TAAGCGTGACGCCGATTAACACGAGCTGCTCTGCGTTTAGGCCGCGAACCGCCGCTCTAT
CAATGAAGAAGTTACATTTGGGCCCGGACCCAGCCATCCCCGGCAGTCGTTTTGCTCACC
TTGTGGTGAAACTATAATTCAGGCGGAAGGTGCTAGGGACGGAAAATTACAGCACATAAC
ACAGTATGTTTAAGATGCCTGAAATACGAAACTATCAGGTCACAGCAACAGACAATCATT
GAGTGGTACTGCCAGCATGGTATTTGCTTCATCCTGCCATCATGGACTAAATGGCTCGTT
GTATTACTGCTGAGTACCCGCAACACGGGTCCGGCGTAGAACACCGACCCCGCGCTAGGG
GTTAGCGTTCGCGTAAAACACTCTACAAGCTCTCAGTTACTAGTAGTAAGCGAGCTGCGA
GCAAGAACGTCCGTAGTGACGCCCGTAGGAGGGACTTAAGGCAGAGCTGGTACTTAGATC
CGGCTTACTACACCCGTCGGTATACCGCGCCATAAACCCGATGTCTGATTGA
>Rosalind_5914
GAGTTTACCCCTAGCTTATCCTACGGACCTCTAATTACAGCATCATCCCGCTTCAGCAAA
CCGTGCCGTTGGGCCCACCGTGTATTGAGGGAATCAGACTCAGATCGGCTTGCAATTATG
ACAGGTGAGGCTGTACAAACATGGGCACCCTCTCTGTTACATCTAAGGAAACGTTGCTCG
CGATATTGGTCCCGCCCAAACCAACCAGGACCTTTCGTCACGTTGGCTGCCGATCTAGAG
GGGTTCGGATATGCGTCGCGTAGACATTCTCCCTAGTCTAGAAGTGGTAACATCCTCCGC
GTGCCTGAGCTGCTCCAATAGACCAACACTATAGCCCCGGATACCAATATCCCAGTCTCT
ACCATCATGGCCCATCTACTTGCAATCCAACCGGAGTTTGCCGCATTGGTCGCGTCGTGG
GAATTGTTGGTAATCATAGACCTGTGCAGCAAACTAGCGCGGTAAAATGCTCTCTGATGG
GTTTCCCGAATCTTCGTAGGAGATGTCGAGTGAATGTTGCGCTGCGCTGATTATCCGTCC
CGTCTTATAGTTATCTCGGGCAATAAATAGAAAACGAAAGTCACGCGATAGCAGACCTCG
CAGCGCACGATCCGATCGGACATGTAGTCTTTCAGTTTCAATGAACCTCACACCAAGTTT
ATGGACCTCATGGGGGCTGGCCCAACATCATAAGACACCAGAGACACAGCCGTCTCCCTC
CTTTCTAACCTCGCCGAAAGACAGACCTGAATATCTTTAATCACTTACACGCAACCTCAT
GTTTAGCATTAAGCGCGTCCATTATCACGCCGTTGACCCCTTAATGCTGTGTGATCGCAT
ACCTTGGCTAAGGATTGTCGACTGTAGTGTTTTTATGCTTTGCGTAAATGTTGCCCCCTA
TGCCTGCTGAATGCATACGTAAAAGCCCCCCGCTCGCCGCTAGTTCGAAGTA
>Rosalind_9040
ATGAAAGATTAACCAGCGCGACATTATCTACAGATGATTCCATTGGTCGGAATCCTATCG
TCAGCAATCCGCATCTACCATGTTACTAGTTGCGTACGGTTCGCTCGTGCATCACGGCAC
TCTAGTAATTATGCGCCCCCAGATATCTTTTGCACACGGGATACTCTATGAGAGATACTT
TCTTCGGTAGATTAGCCATTCAGCGCGAGGTATGTAGCCCAGGACCGCTAGCCTGCGGAT
CGCAACCTGAGTCTGACAATGTGGGGAGCGTTTCGTGGGCGGGCGAACTCCATCACGCGG
TACAAGCTCATGTGCCAATTACTTGTTACGAGGTTATGGCTTGCTTAGGATGTAAATCAA
TAACCTTAGTCAAGAACTTGGTCTACACTGGAATCCGAACGCGCGACCCACTAACCGGGC
CTGTATATCTGGTTTGGGTCAATAGTCCTTAGCTCCAGAGAATATAGAGCTGTTGACGTA
GAACGGTGCTGTTGACCGAATTTGCGCGGCACTTGCACCTGACTGGTCCGCTTCTCGATC
GAATCGGCAAGTATCGAAATTCAGATGCATCGCCCTGGACGAATCACTAACTAGGCTAAC
GACTGCTCCTATCCAACCGTTTTCCTACGATCAGAGGGCCGTGCTACTTTTATGATAGTT
TGCCTGCTCGGAACTCAGCGCTCATAGTTCCAGTGAGAAAGGAACCAGTGCAGAACGTCC
TTATAATACGGAGGCTTCTGAGTGAACAACACCATATGACGACCTGGAGTTGATCAGGCT
TGAATGGATCTACATGTACTCCTTATGAGTGATAGTCAATTAATGTCCAGGCGAACGAAT
TGAAGGCGAACAATTGTAGAGGTTACCATGTTATTGAAATGGCCGTAGGAGTTGCCTACC
TGTCTCCCGTTCCGGTTGTACGGTCTCACAAAGTGTAACCCGGGTATACACC
>Rosalind_3778
TTAAAGGCTTTTAGAACAGGCCGCACGCTGTCGCGTTGACCCTCGGCCGAGGTTCGACCA
GAGGAATGACCCAGGTGTACGCCAGGGACTAAGCTACATTGTACGCGGCTTACGCCCGGC
GCAGGGGTAAAGAAGATAGTAAGTGGCGTGGAGTGTGACCCTAAACTTCGGACGCGTGAG
GAATGGTGTAGCGGATCCGCGCTAGATATGCGCGCTAGGCCGGATCAGTCTGGTATTAGA
TAACGGTATCTCATGTTTGCCACGACGCGGCGCCGAAGTACAGTGTGGGCATGCATGATC
CCCCTCGATTATTGTCGATGGTCTCTCAGGACCACAGGCGTGGGTCGTCTCGTCCGGCAT
AACGAATGAATCACCGCCGCCACCGGAGCTACCCTTAATCCCACAGTGGGAACCACTCCG
CTATGATAATGCATGCCGAGGCCGCGCTTAAGGAATTTCTTTGAGAGCCTGTATGGTTAT
TGGCAAGCTATGAAACTTGTGTCGCCACGTGTCGCGTTTTGGTGACTAGTGGCTGGGCGT
CAGGTTTTGTTAGTAATCATCACGGAATTATGGCAGCAGACACGGCTTCAGAAAAGAGGG
CCGCGGTACAATCGGGGCCAAAGTTTCGTTATGCCAAGTCGTTACTCTCACGGAGCAAAG
CCACTGCGCTCGCTAAGTGTCAAGGTAAAACCCGCCAACGTGTTCCAGTCGAGCGTAGAC
ACTAGCCCAGTTTACTAAGTTGGGTTCTTTACCCTGTAAAGCCCCGAAACGGATGCGGAG
CGCTATCGACCGATAGATGCGCGTGTGCTGATCGTAGTTGCGTCTCGAGTATAACTGATC
GAAGAAAAATGTACTAGTAAAAGCGATCGTGGTGAACTCATCAGGGTCCCAATAGCCCAA
ACATGGGGGACTGTGGGGCTATAACGTCATGTTGGCAGAGTAGATAGCGATT
>Rosalind_8047
CCGCTCGGTTCCAGCACACTCCTGGGTCAGTGAGGACGTTAGGGGCAAGTTTTTCACCCC
TAGAAGGTATTGTGCGAGAAGCGCTAACTGTGTCCGTCTTCATTAATTGCCGTCCCCGTA
CGGAACGTTACCCTAAGGCGAAACTGCATCAAAGTGACCCAAGTAGATCCCAAGCGCGGT
TGTAAATCTATCATGAAGACTTCGACCGACCAAGCGTCGGAAACCCGGCGGATGCGTAGG
TTAAAAAACACTTCCCAACCACGGTATTCAACACTAAATAACCGGGGGCGGAGTTCTTCA
GGTTTCCTAATCAATCTCTAGTAACCTCAAACGCTAGGCGTGGTCTCTCCGTTGACTAAC
GCTCTGTGCCCCATTAGGGGTAATACGAATGTAGGTCGCTATGACAACTCGCGATGGGGC
GATCGTACAGAGCCAAGCTGAGGTAGCTTCCAAATGACACCATTCCGCGATCGTCGCATC
CACCTCCCGAGCACCCCAGCCGTCAATTCCAGCCAGATAACAATTGTGATCCATGACACT
CGCAGTTGTCTGACCGACAGTTGTGTTCGCTCCTCGGAGGGGGTTCCCCTTAATTTTAGA
GTAAATTACGAATCTCACATACTGATCTACGTACTACACGGAAGCCCTTGTGTGGGGACG
TTCTCTACTCTCAAGACGGGCCAATAAGGAAGTGGGGCCATTAGAACGCACGTATACGAA
AACACCAGCCAAGAGAGCATTATTAAGAGATATGCAAGGCTGTTTCACAGTGCGGCGCCC
AAGTTCAGACAGTTACGAGAGAGGCTTTTGTCACTGATGATAGTAGTCGGTTTGATTCCT
AGTTGATGCCTCACGCGCGTTCGCCCAGCGGACCATGTGAGTTAAGTTCGACCAGAGTCT
ATTGGCCAATTAGTGTAGTCGGCTTGAGAATTCGACCAGTTATGGGTTCAGT
>Rosalind_4099
AAGCTACACACTAAACGGTTTGAGGGGTAAGCACAAAGAAGTTGGAACCGTCCTCATTTC
GTCGTCTAATTCCCAGTAAATCACTTATAAGGTGACTCACCAGGAGTTCAACATGAATGC
TTAGGACAGGTTACTTAGAAGGCGTCACTTCTATGGTTTAAGAGTTGCAGGCACACAGGT
ACTGTTGTGTTACTAAAACGCCCGCCACGTTGATTGAATCCTACTTTCTTCTGCTCTTAG
TGGTACCATCGCTTGTATCTACAGAAAAATGTCAGCTGAACCCACACTTCTGATCACCCT
AGTAGCGCTCCCGCGGCTCACAGAATACTTAACGAATGGCTAACTAACCTTCTTGATACA
CCTACATGAGATTTAAAATGAAAGACCTGCGCACGAAACTGAGATTGGGGGCTTCTGAAC
AAAGCTGGGGTATGATCGGGTGGCACGCCTTGCCTTGCCACAAGATCTGGTGACATGAAC
CTGGAGGGGTGGAGCCGCCAAAAGAATACGTCAGCCAGACAAGGTAACCGCAAACTCTTA
CGGCTACTAGGGTCCATAGAGCCGGTGACTGAAACCGAGTGCCCTCTTCACTGTCATCAG
CGTGTGGGTGGTTTTATTTGAAGGAAGTCGACAGGAATGACAGTGGGCTCGGAAAACCAT
AGACCGCTCTCGGATACCTGCTCCGGTTGCTCCTTTCCTATGTAGTCGTGTCACGATTAA
TTGATCGGTTCCTCCCCTAAAATCGCGATGACACCGGTAAAGAACAAAATCGCACGTGGA
CCAAACAAGAGGTTGGATCTTATATTCAGGTGCCTGGTCGGATCACCCGGTATGTCCAGC
CGGGCGAAATCGATGACGGGGCGATGCTAGCGGCCGTTTCATATGGATCTGTGCGTGACC
CAGGGTATTTTCTGATTTGCCCTGTGTTTGATGCAGGCTACCCAAGCATCGC
>Rosalind_7479
TAGGGGCTGGGAGGCCTATGTTCTCGTAACTTACTCCGGCCCCTGGTTTGGGTAAACGAG
CGTGGGAAACGTAATCAGACTTTGCGGTCGCGCCACGCCCCTGTGCTGGAAGCAACGGTG
CGCAAACCCGGAGTGGATCGAGGCACCGATTTCGATTTCGTCACCTCGTGGCCCCAGCTC
TTCTCCGACTACGATATTCGGCTAGTTGAGTCACGTCAAGGTATTGCTCACGGGTGAAGC
TTGTGGTCTAAGCAGTAGTGAGACCAGTCGGACCGATCCGGCTCGCTAGGGTACGATGCA
TTGCGTGGTCCGATTTAGAGGCTGCATTTACTATTTCGATCGATTGCCTTAGGGATCTTA
CCTAGCTTTGTAGACCGGTGATCCGCGGAGTTGATATACACTTCGTGCGTGGTTGAGCGG
GCGAGGCGTCTTGTACTAATTGTGCGAGTATCGAACGATGTGATACCTTTAAACCCAGCT
ATTACCTTCCTCCTGTTGAACGGCTCTTCTAATCGACTGTACGTTCGCGCTGCGAGCATT
CTCTGTTGACGATTTCCTGCTGGGCCATTAAAGTTTGTGAGGTAACAGTAGGTAGACAAT
CCTTACGGGAAATGATGAGTGGTGCGCTACGCGATCGATGATTTCACCAGCAGTCTTGCC
CTGGCCCCCGCAGGCGAAACCCTTCGAGAGGCGGATGCTTAGGCCTAATGGGCGACATTG
CTCCCAGTTACTGCCGTGATGCAACGCGGAACAATCCTGGCGTGCATCCGACAGGGTTAC
GTTATGTATGTAGATCCTCGGCGATAGATGAGCGGCAAAATCTGGCCAGGCTCCTGTCTC
ATTAAGAGAAGAAGCAATACATTTAGAGTAGCCCTCGGCCGTGCCTGTGCGAAGAATTTT
AACTGGGCTTCGCCGGTGAGGGTTCAGCCCTCTCGGATTATAGGTGTGCTCG
>Rosalind_9983
AGCGAAATCTTTTATCCTGTAGTCACAAAGCCATCAACTAGAATTACCAGGTTCGGCATC
AATGGATATCTGCTGCCAGAGAAACTGGACGCGAAATGAGGTAGAGGTAAGCAGCGCCAG
TTTAACTATTTAACCCTTTATAAGATATGATCTCCACTTTGGATTCACCCCCACGGGTTG
TCGGGACTCTACCCGCCCTGCGGTAATGTGTTTCGTCGGTTTTTAATTTAAGGTGTCTAC
AAGCAAGCTGTCGGTACGGGAAGCTTGCACGGGGTTTGTTTCGCCTACACGAGTCGGACG
TGATCCAGTGTTATTGATACAACATTACGGCTTACTCTCTAAGTTTGGCTAACATACGAG
GTAACGTACCCATGTCGCGGCTTATACATACATCGGACTCTTCGCCTCCACAACTTATCG
ACCAACTGTAGATAGACTGTTCGCGCTACAGAGTGGCTCAATGCCTTTTGGGCCTTGTAA
TTGACTTCCACTGTCTATCGGCAAAGAATCGGTTTCAGGCCCACAGAAGGGACAGCTGAC
GAAACACAAACGGCTGTCTGTATATACATTTAGTTTCCACTGTCATACTCCCTATCGGGG
CGAACATTGTTGTATTTCAATAGGATTTTTCGAGTTACACGGCCTCCGGTGTCTCCTTTC
TCCATGAGTGCAGTTATTGCAATCCTTTGCGTTTTGACTAAATCACCTAGATAGAGCAGC
ACAAGTTGAGGTACTGCCGCCAGAGGTTCACGAAGGCTAGTGGTTCCACGATGACGCGGA
GCCGCGAAACACACCGTGTTGGACTCGTAACCTGGTGTACCCCCGAGAGCCGCCTTGCAG
GATAGGTCAGGAATTATAGCTTCGTGAAGAATCATATCGTCCGCGGTCATATCTACCCGT
GAATTGCGCATTGCCAAAACCCTTTGCCTAAAAACGACCAATTCCATTGTTC
>Rosalind_3380
GGTAACGTTGATCCGACGCTATATTATGAAATATTCCAATACCTATAAGTCCAGTGTGCC
AGGTAAACTGAGTCCGGGCCTTTAGCGGCCAATACCCGATGGATCCATCGCCCGCTCTGA
TAATGTAACACTGTATGATGGCACGACACCCCTAAGTATAGCGCCCCGATGATAACACAA
TTATCGTGCTAGCGCGGAGTACAGACGGTCAAAACCCACTACCGATGCGAACGGACGGCC
TCCCGTATCCGCTGCGTGTACGCACACGTACGAATGTGCAGTAAACTGAGGTATCCACGT
CTAGACACGGAGGAGCGCGGATGTAACAGTGAACCACGGTCGAACAGGCGCGAAGAAACT
AGTTAGAGGAAAACTAGTCATTTAAAGGGTGATGGGTATTTATATTTTGCCCGTGATGGC
GATCCCACCTCACTTCCACGATCGCGAATCTGGACACAGGCGATTAGTGATTCACATGAG
TCTTCCTCCGGGTTGATTATCGCGATAAGCGTATGAGCTAGTTAGGCTGTTAGCTTGCGA
ATAGACCTAATTAGTTTATGGGATAAAACGGGCCAGGTCTGCCCATCAGTCAGGCTCCCA
TGTCGTGAAAGGCCGGAGTAAATGCATAGGGACAAATGACGCCTATTTAACCGTAGAGTC
GGGCCCAGCGGCCGAAAGACTGTCTCAGTCACCCAGTAGCCTCATACCTTCCGGTTGTCT
ATATTATGGAGGAGCGGTTAATGTCGTTCAATGAGCCATCCGTCATCGAAGGATGTAGTA
CATTATGCATAAACCTTTCCATAATCAGGAATCCTAACTGGCTCTTAGCTCTGGGCGCGG
ATAAGGCCGTATAGAGTTAGCCGCAAGTTGAACTTGTTGTATGCGACCAGAAGAATTTGA
TCACTATCGATTAGCTGTTGCAAAGGGTTGGCACACGGAATAGCCACGATCT
"""

# ------------------------------------------------------------
# DO NOT EDIT BELOW THIS LINE
# ------------------------------------------------------------

# Parse FASTA input
dna_strings = []
current = ""

for line in fasta_input.strip().splitlines():
    if line.startswith(">"):
        if current:
            dna_strings.append(current)
        current = ""
    else:
        current += line.strip()

if current:
    dna_strings.append(current)

length = len(dna_strings[0])

# Initialize profile matrix
profile = {
    'A': [0] * length,
    'C': [0] * length,
    'G': [0] * length,
    'T': [0] * length
}

# Build profile matrix
for dna in dna_strings:
    for i, nucleotide in enumerate(dna):
        profile[nucleotide][i] += 1

# Build consensus string
consensus = ""
for i in range(length):
    consensus += max(profile, key=lambda x: profile[x][i])

# Print results
print(consensus)
for nucleotide in ["A", "C", "G", "T"]:
    print(f"{nucleotide}: {' '.join(map(str, profile[nucleotide]))}")
