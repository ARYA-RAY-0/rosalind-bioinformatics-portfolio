# ============================================================
# ROSALIND PROBLEM: GRPH - Overlap Graphs
# INPUT: DNA strings in FASTA format
# OUTPUT: Adjacency list of the overlap graph (k=3)
# ============================================================

fasta_input = """
>Rosalind_9297
TCACCTGGGTACGCGACAGTATTGAAGCTGCCCGGGGAGTGGCATCTGAAACGGGATCCT
ACCACCGCTGTACACTCCTATGATGTT
>Rosalind_7826
ACTATACGAATAGCATCTAAACCCAGCTACGAGTAGTGGTGGAAAGGCGAACGTTGTATA
CAATTACTTATGGCGATCGGAATGAATGTTCCCCTTCCG
>Rosalind_2748
TAGGATCGAGATTGCGAAGATTAATTAAACTGCTCGTCACTTCTTAATTAATACCCGCCA
ATCGCGTCGAGCCAGGAGGTGACTGCCGTA
>Rosalind_0139
TTCATTTATTCCCCCTAGTTACCGCAAGCTTCAGTTAATACCGGTTTACAGAGCGCACGC
CCCTCCTTGCACCTCCAGCGGTTTGCGACTGAAGG
>Rosalind_2346
GTTTCTAGGTCAAAAATCGGGCCATGTTACTCTAGTCTGCACTTTATCGCGCACAAGTCC
TATTACGATAACGCCTACTTGCGTCTAGTTGG
>Rosalind_7179
GGTGCCACGTTCGGGGATCCCATTCCCATATGTTCTTACGCATAAATTAACCAAGTGCCC
GTAATGCTACCTCGACGTCGGGC
>Rosalind_9849
GGTACCAGCGCCACCTTACCCCGAGTTGAGATGAAGTGAATCTCGCCCTGCGTGTCGCAG
TCTTGGGAACTTCAGACCCCCGGCAG
>Rosalind_1991
TTCTTATAGAGCAATATACGATGTGCCGACATGGCTCGTTTACTTGGCTAGCAACAAGTG
GATGGACCATTAGTAGGAGGTGAA
>Rosalind_4278
GACCTGTCCAACTTACCCCGTAGTTAGGACGGAAACAAGTCAGAGAAACTCCTTCGTTAA
CTTATAGCCTTTCTATACGTCGGCGGCCACTCCCCACTTT
>Rosalind_8590
TCACCCCACCTTTTGTCAGGTAACTACTTAGATGCTGTACGAAACTATCTGTAGCGATGG
TATAACCGATGGATTTAGAGTCC
>Rosalind_5236
CCCAGTGTGGTAACTCTGCCAGAGGGTTTTTGGTAGTACCATGGAGTCCGGTGGTTTCTA
ACCTTGTCACACTGCGCCATTGAGCCAGTCTAGAA
>Rosalind_1159
GAGACGGCACCTACGTTAGGGTCTAAGCTAGTTGTTGTGATGGGATGGATAGCTGGAAAT
ACAAACTTTTCTAAACCCTTGCTCCA
>Rosalind_7477
GTGGTAAGCTCCCCGCTATAGTGGAATACATGGAAATATATTGTCCTGGTCTGTATCGAT
GTGAACGCAATCGACACCCATG
>Rosalind_3084
GTTGTACGAAACAGTTTCGAAGGCAGACCTTGGCGTTGTAGAATGGATTCGGTGCCCTGG
GATGAATTTCCAGATTTGCCTCTAGCTCGAC
>Rosalind_0785
GCCGCCGACCTCGTCCATTGCACATAGAGGGCTCCCTACGCACCTGGTTATTATTCTTTC
AATTTGTCCCAGGACCTTCAACA
>Rosalind_0711
ATGATTTCCTAACCAGGGCAGCCCTAGTCGGTTGCACAGCACGCTCATTCTTACGGGTCT
TTTCCACGTGAACCACAAGGGATCTTTG
>Rosalind_1422
AAATCGAGACGATTGATAAATGGAGGCTCCAGTCCCTTTAGAACGCTCCATCGGAGCAAG
ACTACCCTGGATTGTTGTCCGGCCAGCAAGCCAGATA
>Rosalind_9534
CTCGCTTATGTTTTCACCGATAAGGGTAGAGTGCCTGTGTGCTTCTATATGCCTTAAACG
CTGCAGTTAAATTTTCCGGTGGCCATACCAAGAA
>Rosalind_4305
GCCAGAGTGGTGACCCTCCTAACGTACGAACGCATGACAGCGGTGCTGAGCGTTCTCGCG
ACCGTTTCTCTTATCGAAGCC
>Rosalind_6291
ATACTATAATCTCAGCGTATTAGCGATGTAGGCGGGTACGTCCGTCATAGGGTCCATCTC
CTGCTATAAAAGAGATGGTTGA
>Rosalind_7991
TAATGTAACACTCGCCATCTAGGTCTGTAGTTGCAAGAGTGGTACAATTGGGCTGAGTCC
TAGAAGTAACGAAACACTTGGACATCTGAT
>Rosalind_4964
CTCCTCGAAACCCGGCCACCAGGTCCCACATTATTCTGGCGCCTTCGGCAACTCTGGTTT
ACTTATATATTGGGACCAGTTCGCTC
>Rosalind_1137
TACCAGGTAGAGATAGTTCAGTTGTCATTAAGCAACCGCCAAGCGCAGAACTTACCCGTT
AGGCTCAGTCGAGCGTAGCTACTGTTAGGTC
>Rosalind_4711
CTGGTCCACGTGGAATGACCGCTTGAGATCCAGCACCCCAGGTCCGTTATCCTAAGCTGG
TCCACGAAACAAGTTTTACCCAA
>Rosalind_0350
TAACCACTATACCTCTTATTTACCCAAAGTATTGCATCTATTCAGATATTCGAACCAATC
CGAGTTCCACACTATCTTCACGCA
>Rosalind_1811
TTAAATTCGACCGCCTTGCTCCCCGTTAGGCCTTCTGAAAGATAGTAGCCATCCGTGATG
GGACAAAACGGACTATCCAAGCCTGTGAAATTACCG
>Rosalind_5251
AATCGATCAGTGGAGCAACATGAGGCGGCGCATCACGGTGGTTGCCAAGAAAATCGCCCA
ATCTGGGACAAGATAGGGGCCTCGTCTATCTAT
>Rosalind_8557
TAGCGTATTTCGCAACGTGGAATCTAGGACGCGGGCCAGTAAAACATAGTACTCGATAGC
GTACGCCAGAGTATCACGGCGGCAGGTCAGCAAT
>Rosalind_5988
GATAACATGCCAGGCACGGCCGTTCATGAGAAGAGGTTTATAAAAGGTCGATTCTCGACG
GCATCATTTTTTGAGTCAAACCTTTATAAAGACGTCT
>Rosalind_6750
CTTTATTGGACCGTAAAGTTGAGTAACACGACACCGTATACAGTGTGTGGAGGACAGGGA
ACAAATCGTCTGTAGTTTAAAC
>Rosalind_0885
GAGAACTCTATTGAGAAGAGGCCCCTGGCGCTTCAATTCATTAGCCCACAATCATGGCGT
GCTCGAAAGCAGGCTAGTTTTTTATA
>Rosalind_8178
GCACTTCATTATATCAAACCGGCACCAACTGCTATTTGCTATGGCAGTAGGGCCAAGCTG
GCGCCCACAGTAGAACCCGAAGAATGA
>Rosalind_9593
TTCGGAGACCCTGGAACCGACCGAGTTTTACGCTAAGAAAAGACAAAACCCCTGTCAATA
CCCGGAACTGATTGACGGTCTGCA
>Rosalind_6941
AACCCTAGAACCCCGCGACGATTGACTTAACAGGATAGGTAACTTGCTACGGATATGAGG
CATCCCATCTCGAGACTTGGTA
>Rosalind_4913
GTCCCCCAGTCAGGCTCACTCTGCGCCCTGTTTAATGAGTTACCCTACGACGTCTACGTA
GTATCGGTACCTAACGCCGTACGTATACCAC
>Rosalind_9314
TCGTCCAATCAAATTATCCGTTCACAGAGGTAGAGTCATGCCATAGAATGCCTGTGCCAG
AATTACATCGCCGCTCCTGTGTTACTCTCTAGGCATG
>Rosalind_5128
CAGAAAAGATAAACTATAAATACCGCTGTTGGCCATGCCTACCCACAGCCAATTAGTCTC
AGACGTTATTGCGCTATCAATT
>Rosalind_6130
AAGCATGGCTATAAATCCGCTCTCTTATCGTACGCTAGTAATACCGTTAACTCCACCTTC
TTCACCTCTACGAACGTGGTGGTGAGGC
>Rosalind_8374
ACTTGGCTGGACAAAAGAACTCGCTCAGTCGTTATCATACCATTCATGTGTTTCCAACGG
ATACTACTTATGGAATCACAACT
>Rosalind_8603
TAGCGGCCGGCTCAGCAGTGGTCACTGCTCCACGGGCTGAAATTGAGTGCGACGTAAGAT
AGGCAACACACGGATGATCTCACAATAGGTCCCACGG
>Rosalind_9934
ATGGCATGAGGATTACAATCTTTCTGCGTAAAGAGTTAGGTTCACATCAATTAATTGGGT
GACTGGCAGTTCAGGGCGCAGTCTCCCAAACCTATCA
>Rosalind_3357
TGAATATTTTTGGTACATCTTACACAAGGCGTGACTGGTAACGAATCACCGCCGTAATAA
CGATATGTTGGCTGCGGACGGCTCA
>Rosalind_3554
AGAACTAAGAGGTTGCCCTAGCGAGGTCCCTATTCGCGCCGGAAGGAGTCCCATCCCTAG
ATTATCCGAGCTCGGGTCTCCACGTCG
>Rosalind_9850
AATAGCGAGAGGCCGGATATAAACGGCAGGTACGGTCGGACGGATTGTACTCAGAAAGTC
TACCTATCTGTTCTTACGCT
>Rosalind_0429
AGAGCTTTCGGTAGCTCATCCCCTGATGCCTACCTTATCAGGTTTGGGATCGGAATAGTC
ACATACCAAAGGGTAGTTGT
>Rosalind_0048
TATGACCTATGACATGGAGGTGACGTACCTCCACGACCCACCTGTCAGCCTCCGGTCGAA
TAGATAGGTGCAACATTAGGATAT
>Rosalind_5695
ATGCGAATATACGGATTTTGACCTAGGCGAACACGAATAAGTAACGCTCGAACTCGGCTC
GCATCAAAGATCATCAGATTGGCAGGGTACGG
>Rosalind_3108
TCCACACGCGAGAGGCTATGGGCTGCACTCACAGGTAGGCAGTTGGGTTGCACTTGACCA
ACTTTCAGGACAAATAGCGTGGGCTATCGCTTTGAT
>Rosalind_9475
ACTAATGTTACAGCAAATGACTTAATACAGTGTATGTTCACGGCCGGCAACCGACCTAAT
CTTCGTCGTGACGTGTATATTAAATGC
>Rosalind_8447
TTCGTTTGTATAAACTGCCAGTTACTAGGACGTAAATTGAAAGTCAGACACTCGACTGTC
TGCCATGGGAATTTCCCAACAGCATGCCGTT
>Rosalind_3499
GAGGGGCGTTTTTTTTGATAAGAATGAGCACAACCTTAAGAAGGCGATTCATAATTCGAT
GCCGGCCCCGTTCTCTTAATTCGCGGATGAC
>Rosalind_5340
AAGCTTAATAATTAAGATCCAGATCTACTATGATGTGGCTGTCAGCGAGCCCTCGAACAC
CTCTGATTTATGGGGACTGAGTT
>Rosalind_2995
CAGAACTAAGTTAGATGTCCAAAAGCAGCACATCAATTCGGTGGACATTTGCCAGACCTC
GCTACACTGGCGGTTGCGGTCCAACAGTAGCACCACG
>Rosalind_3708
GGGCGTACGTATGACCATACAAATAGCGTCTGGCTACTCCCATAAAACCCGACTCGATGG
CCTACCGGGTATCTTTAAAGCCATAACAAGAGTA
>Rosalind_3668
CTAATCTTATCTGGACGTATGTTGTCCTCAAAAGTGCCGGGCTTTAACTAAGACCACTCA
AAGTCAGAATCAGGTAGGACC
>Rosalind_9529
TGGTAGCTGTAGTCTACAGCAGGGATTTTATCGACCAGCCCCATACGGTGAGGATGGCCC
TGACCTTTGCTTAGTGGATTGATCCACTACACGT
>Rosalind_2919
GTAGATTTTCCCTTTCCTTATCTTGCCCGCTTCGACGTTAGCCCGTTGAAACTATCCTTT
GCCCCCGAATAGTACATGAGAGGCGATAATC
>Rosalind_5631
TGTAACGGCGGCTTGTCCCTTACCTATGCATGATATAAGACCGGGTCTTGCTGGCTAGCA
CCGTCAGCCGAGCTCATAGTGAGTGCCTTAACAGAAAGCA
>Rosalind_3168
GGTGAATATTGATCGTTGGATCCACCACTCGACCCCCTAGCTAACGCTCAAAAAAACACT
ATGCTGCCCGAATGTCTTTTGACGACC
>Rosalind_4291
ATTGAGATTTTTAGTGCGATGCAGTTACTGGAAACATTGATCTGGTCTCTAAAAGAGACT
ATAAACGTGCATGAGTACTAGTATGGCCGT
>Rosalind_1007
ACAAGTCTTCTATGGAGTCAGTGAGCCTATGGGTGTAGTGCACAACCCGACTGCCTTAGG
CGAAAATGGGGCCTTCTCAGTGGGAGTGGTACGGCA
>Rosalind_2757
TGGGAGGAGCTTGATGAATATGTATAGATCATGATCTGATATGCACTACAGGTTACGCCC
GCCATGAAATGAGGTATACGTTTTCCACA
>Rosalind_6461
CACTCTGCCTCGTTAGTAAATCGGTTCCATCAATGGTCCAACTAAGTCTCTTCGTCGGGT
CAATCAATGACCATGTCCGATG
>Rosalind_4543
TCTGTCGGGGGTTGTTTGACGGCTGCGATGCTCGCTGTAGACTTGGCACGGGTTGCGCAA
AAGGACGACAGCGCCGTCGCTTTCGATACTAGCGATCGAT
>Rosalind_2437
CTTATACATTGAACGTTTATTATATGATTAATGGCGGTAGTTTCAGCTGGCCACTGGTTC
TCCCACGGTACGTGGTGGGCAACGAGGAACGCCTTGTGGG
>Rosalind_6852
GCTTCCCTATCGGAGGGTTGCCCTCACTACTTTCTGTTCCAAGTGAAGATTCTGAGAGAA
TGAATGACAGGTCTAGCTGGGTCTATGGCCG
>Rosalind_6673
GAATAGGTTGAATATCGGACGGAAAGAAACCAGGCTACCCCTCGTTCCCATCCGGCTTAT
GTACAGTAAGGCTAGTCGTCACCGTGGTATTGCGGTA
>Rosalind_9302
GAACCTTTTTGGACTAACTATCGGATAGGATGCGTATTGTTGAGCGGAGAAGACTAATAG
CGTGGCCCCTGCTCTTCGGGCCGGGCCGACAGGTTTT
>Rosalind_3547
AGAGCAGATTCACCATGGGGGGCGCTAGACCGATGCACGGTTATCACAGTATGAGACCCG
AGTACTCTAGGATCTCTACATCCGTCACGCTAGAT
>Rosalind_1113
GCCCATCGTCAATTCTTAAGATGCTGTTTATGGCGGAAGAAGCTGTGAGCTTATAAAACG
ATATCGCCGGTCCATTATGTGCACTGATGGTCGATACAC
>Rosalind_2073
GTTAGCACAGGCAATAATGCCGGGATAGGCGCTGCAGCATAATCAAACTGTCGTAACTAG
ACACTTTCCAATCCAAGCTAACATCGC
>Rosalind_3126
ATGCACCGAGATGAGGAATTAGCGGTCCGCAAGTGTTGTTGAGTACCATTAAGGAGTGAG
GACTGTGTGTCATGCCGCGCG
>Rosalind_6532
GTAAACCTTGACTTTTTAAATACGTGTTCTGCCGCCAATCTGATAGATCTCGCGCCCAAT
AATAGTGTGGCAGGGCATTGCTGACT
>Rosalind_0456
TTTTAGCACTTTGTATAGATTTCAACCGCCGTCTTTAATCTCTGTACAGCCTGACTCCGA
TGGTGTTAGGCGGGGCAACGAAGTAGGCTTTCATGT
>Rosalind_4987
TGCTCCTCAGAATGAAACCAGGATGATGAATCACAGGCTTAGTGTGAGTTCGCTCCAGAC
GACTTCCTTCTTGTATTGTACGCCTG
>Rosalind_4401
CTCACAAAAGTGAGCACTCTCAGGTTAGAAACCTTTTTAGGTCCGGCGCAACGGGTGCTT
CGGGCTACGAGAACCTATTGGTCCCATA
>Rosalind_2934
TACCGCTATCCCCTCTTAAGAGGTAGGTGGGTCACGACTTAATTAGGACCCCGATCGGGG
GTTCAGATTTCAATATCCATATGGTGA
>Rosalind_7140
TATACGAGGTGGACGCTTGCTGCTCTCCTTTCAAGTCAGCTCCAGCCAGACGTCTAGAAT
ACATCTATAAGCTTATTACTTCGAGTGGTT
>Rosalind_5723
TGAGTGCTTGAATTAAAGTGCATGCTGTTTACTTAACGTTCTCAAGACCGTGCTCGTTCC
ATACGGTATAACACCCTCCGCAA
>Rosalind_8335
TAGATTTGCGCCATGGCGTACGAGCATCCAGATGTGCCTCTTGATTCAACCAGATCAACC
TGGGGCCGTTCGATACACAGTGA
>Rosalind_5530
ATCCCAAGCTTATTTTAGAGCGGTTTGCGCGCTAATTCTGGAGACCACTTCACCTGGCGC
ATAATTTCGTATCCAACGCCCCCACGGGTACCCA
>Rosalind_0118
GACGTAGTAGCGGCGAGCGCACAGATGCGAAAAACACTCCCGCAGGCGCCTTTGATGCAA
CGTATGACAGGAGCGCCCCTGCCCGCGG
>Rosalind_5614
GTACGCCGGGCCAAAACTTGTTTGGTCTGATTTACTATACCGTTAGCCTGACCGAATTGT
GTAGGAATATCAGTCCAGCGCTGACGTGGTCATGAGCC
>Rosalind_4405
CGCCACATCGCCTTTTTTAATAAACTTGCCCCTCTTAAGAACCCAGGCAGCCACGGTGTC
GGAACGTGCTCAGAACCGAATGTACGGATACT
>Rosalind_5565
TAGAAATTTGTCTACTAAGGCTTAGTAGTTTGACGAAAGCGCTAGTCCCCAGACTGAGTT
CCAAACTCGGAATCAAACCTACAGTCCTGGCCAGGTTGT
>Rosalind_6748
TCCGTACATTGAGGTGTCTTGCACATTGGGCCAACCTTAATCTTTTAACGTTGTCGTCTT
ACAGAGGTTAAGCAGACTGGCACCATTGTCGA
>Rosalind_9726
TATCACTGGTATGCCGAGCCTTAAGAAGTGGGCAGGGGTATGAGATATTAAATGAGGACC
AGTACCCGAACCGCCGTTAGGCTCGATGA
>Rosalind_7242
GAGAAAAAGGTTTTAGGTGATGATCTACTGGAAGGCACGGTATGGACGGGAGGCCAAATC
TACGTAGGGGGACCTGGCGGGGTAATGTTTC
>Rosalind_8936
TGCAGCCCATCGGTTTCATTCCCCTACGTCGGCACTTCTTTGCTAGATGCGCATAATTGG
TCACAATTAGTGGCCTTTTTTT
>Rosalind_9830
GAGAATATTCACCGCGAATAACGGCTTCTCTAAACGAGCAGACCACTATACGGTACACAG
CAAGTCGCTCCCTGATATTCGCAAGTCGTATCGTCG
>Rosalind_7096
TTTGAGATCCCATCAAGTTGATCCCGGAGGGTGAATTGGTCAGCCTAAAAGAGAAAGAGT
ACCTATTCCCGTGACCTCGTTAACG
>Rosalind_9251
CCAGCAGCAGAGCGTGGAGGAGGCGATAATGAACGAAAGTGGCAAAGTTACGAAGGCCGG
AAGGCCGTGACACGGCAAGATATTTTTTGC
>Rosalind_4713
TTCAATGTCTCGGATAACAGCTGAAGCCTAGGCAATCGAGATGTAGCTGGAGTAGCCAAT
GGTTCACAGTTTTCCACTAGCGGTCCGCACAATGCC
>Rosalind_2336
ATCTTCCAAGCCACCGTTCTTTTGCGGGCGCATTACCCAAGACGTGTGAATATTTGCTTT
GTCGGGGATAGATATATGTTCGGCGCG
>Rosalind_2731
CACGCGGTTGGATTTGCGTGAGGCATCTACTGTGCCATGGGATACATTCCAGAAAATCGG
CACGCTGTCGATAATCTTTGTCCCATA
>Rosalind_2368
AGAGTTTCCCTCTGTGTGGCCTTATACGACACTAAAGGCTCAGCAGACCCCCAGCTTGTG
TTAGTTCAGCCCGTGCCGGTAGCGAAGCACTTAGTA
>Rosalind_3301
CATGACACCCACCCTTACGTGATTTTTGTGGTAGCACGGGGCTCGCAGGTCCAGAATCTG
AACATGTGACCCGTAACTAGTAACCTCTAA
>Rosalind_3800
TCTCGGTTGGACTGCATTAGGTAGAGTCGAGTGCATTCAGTTGTCGTAGCAACTCCCGCT
TGTACGGGCCGCTTAGTCGAGAAGTTTCCATCGCCACC
>Rosalind_1073
AGTGATGGCCCTGTTTATCAACGAGATTGTCTTGAGCGTCCCGGCTACGGAATACGATAT
ATACATAAGTAACTATGTTGTAAAAGCAC
>Rosalind_3244
TCCACGGAGTTGGCCGGTAAAGGCCCCGCGCCTGGCTTTTTATGTTACTGCCAAATTAGC
CTGCTTGGGCATTATGCTGGA
"""

k = 3  # Overlap length

# ------------------------------------------------------------
# DO NOT EDIT BELOW THIS LINE
# ------------------------------------------------------------

# Parse FASTA input
sequences = {}
current_label = ""
for line in fasta_input.strip().splitlines():
    if line.startswith(">"):
        current_label = line[1:]
        sequences[current_label] = ""
    else:
        sequences[current_label] += line.strip()

# Build overlap graph adjacency list
edges = []

for s_label, s_seq in sequences.items():
    s_suffix = s_seq[-k:]
    for t_label, t_seq in sequences.items():
        if s_label == t_label:
            continue  # no loops
        t_prefix = t_seq[:k]
        if s_suffix == t_prefix:
            edges.append((s_label, t_label))

# Print adjacency list
for edge in edges:
    print(edge[0], edge[1])
